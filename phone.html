<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Trigger</title>
    </head>
    <body>
        <span id="code"></span>

        <button onclick="sendAction()">Lees de tijd voor</button>
        <button onclick="reset_room()">Andere code gebruiken</button>

        <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
        <script>
            const socket = io();

            function set_room(room_code) {
                localStorage.setItem("room_phone", room_code);
                document.getElementById("code").innerHTML = room_code;
                socket.emit("join-room", room_code);
            }

            if (localStorage.getItem("room_phone") !== null) {
                var room = localStorage.getItem("room_phone");
            } else {
                var room = prompt("Room code");
                localStorage.setItem("room_phone", room);
            }

            set_room(room);

            function sendAction() {
                socket.emit("phone-button-pressed", {
                    roomCode: room,
                    payload: { clickedAt: Date.now() },
                });
            }

            function reset_room() {
                let room = prompt("Room code");
                set_room(room);
            }
        </script>
    </body>
</html>
